import java.io.BufferedInputStream;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Collection;


public class Main {
	
	
	public static void main(String ... args){
		String dir = null;
		if(args==null || args.length==0)
			dir = "txt";
		else
		 dir= args[0];
		 TextSearcher searcher = new TextSearcher();
		 long startTime =System.currentTimeMillis();
		 searcher.proccessDir(dir, TextSearcher.SearchStructure.InverseIndex);
		 System.out.println("Time of dir proccessing: "+(System.currentTimeMillis() - startTime)/1000 +"s");
		 System.out.println("Number of procced documents: " + searcher.getFilesNum());
		 System.out.println("Number of proccessed words: "+searcher.getWordsCount());
		 BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
		 String searchString = null;
		try {
			searchString = reader.readLine();
		} catch (IOException e) {			
			e.printStackTrace();
		}
		 while(searchString!=null && !searchString.equals("")){
			 try {
					searchString = reader.readLine();
					startTime = System.currentTimeMillis();
					Collection res = searcher.searchInDocuments(searchString);									
					System.out.println("Search time: "+(System.currentTimeMillis() - startTime)/1000f +"s");
					if(res!=null)
						printCollection(res);
				} catch (IOException e) {			
					e.printStackTrace();
				}
		 }
		 
	}
	
	public static void printCollection(Collection<String> c){
		for(String s:c)
			System.out.println(s);
	}
}
