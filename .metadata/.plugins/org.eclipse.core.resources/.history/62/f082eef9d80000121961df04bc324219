import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.Collection;
import java.util.TreeSet;


public class Main {
	
	
	public static void main(String ... args){
		String dir = null;
		if(args!=null)
			for(String arg:args){
				
			}
		else
			dir= args[0];
		if(args==null || args.length==0)
			dir = "txt";
		else
		 
		 TextSearcher searcher = new TextSearcher();
		 long startTime =System.currentTimeMillis();
		 searcher.proccessDir(dir, TextSearcher.SearchStructure.InverseIndex);
		 System.out.println("Time of dir proccessing: "+(System.currentTimeMillis() - startTime)/1000 +"s");
		 System.out.println("Number of procced documents: " + searcher.getFilesNum());
		 System.out.println("Number of words in dictionary: "+searcher.getWordsCount());
		 BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
		 String searchString = null;
		 System.out.println("Enter search string...");
		try {
			searchString = reader.readLine();
		} catch (IOException e) {			
			e.printStackTrace();
		}
		
		 while(searchString==null || !searchString.trim().toLowerCase().equals("quit") ){
			 try {
					
					startTime = System.currentTimeMillis();
					TreeSet<String> res = searcher.searchInDocuments(searchString);									
					System.out.println("Search time: "+(System.currentTimeMillis() - startTime)/1000f +"s");					
					printCollection(res);					
					System.out.println("Enter search string...");
					searchString = reader.readLine();
				} catch (IOException e) {			
					e.printStackTrace();
				}
		 }
		 
	}
	
	public static void printCollection(Collection<String> c){
		if(c==null)
		{
			System.out.println("Nothing find.");
			return ;
		}
		System.out.println("Seached files: "+ c.size());
		for(String s:c){
			System.out.print(s);
			System.out.print("\t");
		}
		System.out.println();
	}
}
